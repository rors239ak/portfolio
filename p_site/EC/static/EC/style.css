:root{
  --max-width:1100px;
  --accent:#3b82f6;
  --muted:#6b7280;
  --bg:#f6f8fb;
  --card:#ffffff;
  --line:#eef2f7;
  --radius:10px;
  --gap:12px;
  --thumb-size:160px;
  --controls-h:56px; /* 必要なら調整 */
}

*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);font-family: "Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; color:#111}
.wrap{max-width:900px;margin:0 auto;padding:24px}

/* header */
header.site-header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
.brand{font-size:1.6rem;font-weight:700;color:var(--accent);text-decoration:none}
.auth{font-size:0.95rem;color:var(--muted)}
.auth form{display:inline}

/* controls / search */
.controls{display:flex;gap:12px;align-items:center;margin-bottom:18px;flex-wrap:nowrap}
.search{
  display:flex;
  align-items:center;
  gap:8px;
  flex:1;
  position:relative;
  background:var(--card);
  padding:8px;
  border-radius:10px;
  border:1px solid var(--line);
  min-width:0;
}
.search input[type="text"]{
  width:100%;
  box-sizing:border-box;
  border:0;
  outline:none;
  padding:10px;
  font-size:0.95rem;
  background:transparent;
}
.search select{flex:0 0 auto;border:1px solid #e6e9ef;background:#fff;padding:6px 8px;border-radius:6px;font-size:0.92rem}
.search .price-range{display:flex;gap:6px;align-items:center}
.search .btn{flex:0 0 auto;white-space:nowrap;margin-left:6px}

/* 左の入力を可能な限り広げる */
.search-input{
  flex:1 1 0%;
  min-width:0; /* 重要：flex内で縮むために必要 */
}

/* 右側のコントロール群を右端に追いやる */
.search-controls{
  display:flex;
  gap:8px;
  align-items:center;
  flex:0 0 auto;
  margin-left:auto; /* ここで右へ固定 */
}

/* 各セレクト・ボタンは伸びない */
.search-controls select,
.search-controls .price-range,
.search-controls .btn{
  flex:0 0 auto;
}

/* buttons */
.btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid #e6e8ee;padding:7px 10px}
.link-create{font-size:0.95rem;color:var(--accent);text-decoration:none;padding:8px 12px;border-radius:8px}

/* summary */
.summary{color:var(--muted);font-size:0.95rem;}

/* card + table */
.card{background:var(--card);border-radius:var(--radius);padding:12px;border:1px solid var(--line);box-shadow:0 6px 18px rgba(11,22,48,0.04)}
table.product-table{width:100%;border-collapse:collapse;font-size:0.95rem}
.product-table thead th{background:#fbfdff;text-align:left;padding:12px;border-bottom:1px solid var(--line);color:#374151;font-weight:600}
.product-table td{padding:12px;border-bottom:1px solid #f5f7fb;vertical-align:middle}
.product-table tr:nth-child(even) td{background:#fbfdff}
.product-table tr:hover td{background:#f6f9ff}

/* image cell */
td.img-cell{width:var(--thumb-size);padding:8px;text-align:center;vertical-align:middle}
.thumb{width:var(--thumb-size);height:var(--thumb-size);display:flex;align-items:center;justify-content:center;overflow:hidden;border-radius:8px;background:#fff;border:1px solid #f0f3f8}
.thumb img{width:100%;height:100%;object-fit:contain;display:block}

/* text columns */
td.desc{max-width:420px;color:#374151;white-space:normal;word-break:break-word}
td.owner{color:var(--muted);font-size:0.92rem}

/* responsive: narrow */
@media (max-width:900px){
  :root{--thumb-size:120px}
  td.desc{max-width:220px}
}

@media (max-width:720px){
  .controls{flex-wrap:wrap}
  .search{flex-direction:column;align-items:stretch;gap:6px}
  .search-controls{margin-left:0;justify-content:space-between;width:100%;flex-wrap:wrap}
  .search-controls .btn{margin-left:0}
  .search-input input[type="text"]{padding:8px}
  /* table → card like */
  table.product-table thead{display:none}
  table.product-table, table.product-table tbody, table.product-table tr, table.product-table td{display:block;width:100%}
  table.product-table tr{margin-bottom:12px;border-radius:8px;padding:10px;background:transparent;border:1px solid transparent}
  table.product-table td{padding:10px;background:var(--card);border-bottom:0}
  td.img-cell{display:flex;justify-content:center;padding-bottom:6px}
  td.desc{padding-top:6px}
  .card{padding:8px}
}

/* small polish */
a,button{transition:all .12s ease}
.btn:hover{filter:brightness(.95)}
.link-create:hover{text-decoration:underline}

/* auth ページなどのレイアウト */
.auth-page{
  min-height: calc(100vh - 40px);
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, rgba(59,130,246,0.04), transparent 40%);
  padding: 24px;
}
.auth-page .container{margin:0;max-width:520px;width:100%;padding:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.auth-page .card{width:100%;max-width:460px;margin:12px 0}
.auth-page h1{text-align:center;color:var(--accent);margin:0 0 18px;font-size:1.5rem;font-weight:700}
.auth-page .control input{padding:10px 12px;font-size:1rem;border-radius:8px;border:1px solid #e6e9ef}
.auth-page .actions{justify-content:center}
.auth-page .actions .btn{min-width:120px}
@media (max-width:560px){
  .auth-page{padding:12px}
  .auth-page .card{padding:18px}
  .auth-page .actions{flex-direction:column;gap:8px}
  .auth-page .actions .btn{width:100%;min-width:0}
}

/* form page */
.form-page{
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 28px 16px;
  background: linear-gradient(180deg, rgba(59,130,246,0.03), transparent 40%);
}
.form-page .container{max-width:760px;width:100%;margin:0;padding:0 12px}
.form-page .page-title{text-align:center;color:var(--accent);font-size:1.5rem;margin:0 0 14px}
.form-card{padding:22px;border-radius:12px;box-shadow:0 12px 30px rgba(11,22,48,0.06);border:1px solid rgba(15,23,42,0.04);background:#fff;display:flex;flex-direction:column;gap:14px}
.form-card .form-row{display:flex;gap:12px;align-items:flex-start}
.form-card label{width:140px;padding-top:6px;font-weight:600;color:#333}
.form-card .control{flex:1}
.form-card .control input[type="text"],.form-card .control input[type="number"],.form-card .control textarea,.form-card .control select,.form-card .control input[type="file"]{width:100%;box-sizing:border-box;padding:10px 12px;border:1px solid #e6e9ef;border-radius:8px;background:#fff;font-size:0.96rem}
.form-card .control textarea{min-height:120px;resize:vertical}
.form-card .hint{color:#6b7280;font-size:0.88rem;margin-top:6px}
.form-actions{display:flex;gap:12px;justify-content:center;margin-top:6px}
.form-actions .btn{min-width:120px}

/* --- 商品詳細ページ（統合・重複削除済み） --- */
/* ベース（カード風） */
.product-page .product-detail {
  width: 100%;
  max-width: 760px;
  margin: 0 auto;
  background: var(--card);
  border-radius: 12px;
  padding: 28px;
  box-shadow: 0 12px 30px rgba(11,22,48,0.06);
  display: flex;
  flex-direction: column;
  align-items: center;    /* 横方向中央 */
  justify-content: center;/* 縦方向は .wrap.product-page で担保 */
  text-align: center;
  box-sizing: border-box;
}

/* ビューポート中央配置（縦横） */
.wrap.product-page {
  width: 100%;
  max-width: none;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  box-sizing: border-box;
}

/* 個別要素の中央揃え */
.product-page .product-title{margin:8px 0 12px;font-size:1.6rem}
.product-page .product-image{
  display: block;
  margin: 12px auto;
  width: auto;            /* 元サイズを基本にする */
  max-width: 480px;       /* 横の上限（必要なら調整） */
  max-height: 60vh;       /* 縦に大きすぎないようにする */
  height: auto;           /* アスペクト比を維持 */
  object-fit: contain;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

/* フォールバック：product-detail 内の他の img もコンテナをはみ出さない */
.product-page .product-detail img {
  max-width: 100%;
  height: auto;
  display: block;
}
.product-page .product-meta{max-width:680px;width:100%;margin:12px auto 0;text-align:center;line-height:1.6}
.product-page .product-actions{margin-top:16px;display:flex;gap:8px;justify-content:center;align-items:center}

/* product-detail 内の子要素を確実に中央揃えにする（back-link を除く） */
.product-page .product-detail > * {
  align-self: center;          /* flex コンテナ内で中央に寄せる */
  width: auto;                 /* 幅が100%で引き伸ばされるのを防ぐ */
}

/* タイトルを確実に中央寄せ */
.product-page .product-title {
  width: 100%;
  text-align: center;
  margin: 8px 0 12px;
}

/* メタ情報を縦並びで中央寄せ（テキストも中央） */
.product-page .product-meta{
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  max-width: 680px;
  width: 100%;
  margin-top: 12px;
}

/* 各行の p を狭い幅に収めつつ中央に */
.product-page .product-meta p{
  width: 100%;
  max-width: 680px;
  margin: 6px 0;
}

/* 画像は常に中央に表示 */
.product-page .product-image{
  display:block;
  margin: 12px auto;
  max-width:480px;
  width:100%;
  height:auto;
  object-fit:contain;
}

/* 戻るリンクは左上に固定（既存の挙動維持） */
.product-page .back-link{ align-self:flex-start; }

/* スマホ時の高さ過剰対策 */
@media (max-height:600px) {
  .wrap.product-page { min-height: calc(100vh - 24px); padding-top:16px; padding-bottom:16px; }
  .product-page .product-detail { padding:18px; }
}

/* index: 商品グリッド（横4列） */
.product-grid{
  display: grid;
  grid-template-columns: repeat(4, 1fr); /* 変更: 4列 */
  gap: 18px;
  align-items: start;
}
.product-item{
  background: var(--card);
  border-radius: 10px;
  padding: 12px;
  text-align: center;
  box-shadow: 0 6px 18px rgba(11,22,48,0.04);
  display:flex;
  flex-direction:column;
  gap:10px;
  min-height: 160px;
}
.product-item .thumb{
  display:block;
  width:100%;
  height:140px;
  overflow:hidden;
  border-radius:8px;
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
}
.product-item .thumb img{
  max-width:100%;
  max-height:100%;
  object-fit:contain;
  display:block;
}
.pi-body{display:flex;flex-direction:column;align-items:center;gap:6px}
.pi-name{font-weight:700;color:inherit;text-decoration:none}
.pi-price{color:var(--muted);font-weight:600}

/* レスポンシブ：幅が狭ければ列数を減らす */
@media (max-width:1200px){
  /* 大きめ画面では 3 列に落とす */
  .product-grid{ grid-template-columns: repeat(3, 1fr); }
}
@media (max-width:980px){
  /* 中くらいは 2 列 */
  .product-grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (max-width:560px){
  /* スマホは 1 列 */
  .product-grid{ grid-template-columns: repeat(1, 1fr); }
}

/* sort-row: 並び替えフォームを下段で右寄せ */
.sort-row{
  display:flex;
  justify-content:flex-end; /* 右寄せ */
  margin:10px 0 6px;        /* controls と summary の間に余白 */
  gap:8px;
}

.sort-form{
  display:inline-flex;
  align-items:center;
  gap:8px;
}

.sort-form .sort-label{ font-weight:600; color:var(--muted); }

/* controls を上下2行に分ける */
.controls-grid{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:18px;
}

/* 上段: 検索（左）と出品ボタン（右）を水平配置 */
.controls-top{
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:space-between;
}

/* search の内部（既存の .search と .search-controls が使われる想定） */
.controls-top .search{flex:1; display:flex; gap:8px; align-items:center}
.controls-top .search .search-input{flex:1}
.controls-top .search .search-controls{display:flex;align-items:center;gap:8px}

/* 下段: 左にフィルタ要約、右に sort を配置 */
.controls-bottom{
  display:flex;
  align-items:center;
  justify-content:space-between; /* ← 左右に振り分ける */
  gap:12px;
  width: 90%;
}

/* filters-left は左寄せ、縦中央に */
.filters-left{
  display:flex;
  align-items:center;
  gap:8px;
  color:var(--muted);
  text-align:left;
  flex: 0 0 auto; /* 幅は内容に合わせる */
}

/* sort-row を右端に固定 */
.sort-row{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:8px;
  flex: 0 0 auto;
  margin-left: auto; /* 保険で右に詰める */
}

/* 両側の要素を同じ高さに見せるためにフォーム内の要素も中央揃え */
.controls-bottom .sort-form,
.controls-bottom .filters-left { height: 100%; }
.controls-bottom .sort-form > * { vertical-align: middle; }

/* モバイルでは中央寄せ */
@media (max-width:720px){
  .controls-top{ flex-direction:column; align-items:stretch; min-height: auto }
  .controls-bottom{ flex-direction:column; align-items:center; gap:6px; min-height: auto }
  .sort-row{ margin-left:0; justify-content:center }
}